<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=description content><meta name=author content="thienlh@thienlu.com"><link rel=icon href=../../images/favicon.png type=image/png><title>Blog 2 :: Internship Report</title>
<link href=../../css/nucleus.css?1765296817 rel=stylesheet><link href=../../css/fontawesome-all.min.css?1765296817 rel=stylesheet><link href=../../css/hybrid.css?1765296817 rel=stylesheet><link href=../../css/featherlight.min.css?1765296817 rel=stylesheet><link href=../../css/perfect-scrollbar.min.css?1765296817 rel=stylesheet><link href=../../css/auto-complete.css?1765296817 rel=stylesheet><link href=../../css/atom-one-dark-reasonable.css?1765296817 rel=stylesheet><link href=../../css/theme.css?1765296817 rel=stylesheet><link href=../../css/hugo-theme.css?1765296817 rel=stylesheet><link href=../../css/theme-workshop.css?1765296817 rel=stylesheet><script src=../../js/jquery-3.3.1.min.js?1765296817></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=../../3-blogstranslated/3.2-blog2/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=../../><svg id="Layer_1" data-name="Layer 1" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff}.cls-2{fill:#f90;fill-rule:evenodd}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09 10.85a4.7 4.7.0 00.19 1.48 7.73 7.73.0 00.54 1.19.77.77.0 01.12.38.64.64.0 01-.32.49l-1 .7a.83.83.0 01-.44.15.69.69.0 01-.49-.23 3.8 3.8.0 01-.6-.77q-.25-.42-.51-1a6.14 6.14.0 01-4.89 2.3 4.54 4.54.0 01-3.32-1.19 4.27 4.27.0 01-1.22-3.2 4.28 4.28.0 011.46-3.4A6.06 6.06.0 017.69 6.46a12.47 12.47.0 011.76.13q.92.13 1.91.36V5.73a3.65 3.65.0 00-.79-2.66A3.81 3.81.0 007.86 2.3a7.71 7.71.0 00-1.79.22 12.78 12.78.0 00-1.79.57 4.55 4.55.0 01-.58.22h-.26q-.35.0-.35-.52V2a1.09 1.09.0 01.12-.58 1.2 1.2.0 01.47-.35A10.88 10.88.0 015.77.32 10.19 10.19.0 018.36.0a6 6 0 014.35 1.35 5.49 5.49.0 011.38 4.09zM7.34 13.38a5.36 5.36.0 001.72-.31A3.63 3.63.0 0010.63 12 2.62 2.62.0 0011.19 11a5.63 5.63.0 00.16-1.44v-.7a14.35 14.35.0 00-1.53-.28 12.37 12.37.0 00-1.56-.1 3.84 3.84.0 00-2.47.67A2.34 2.34.0 005 11a2.35 2.35.0 00.61 1.76A2.4 2.4.0 007.34 13.38zm13.35 1.8a1 1 0 01-.64-.16 1.3 1.3.0 01-.35-.65L15.81 1.51a3 3 0 01-.15-.67.36.36.0 01.41-.41H17.7a1 1 0 01.65.16 1.4 1.4.0 01.33.65l2.79 11 2.59-11A1.17 1.17.0 0124.39.6a1.1 1.1.0 01.67-.16H26.4a1.1 1.1.0 01.67.16 1.17 1.17.0 01.32.65L30 12.39 32.88 1.25A1.39 1.39.0 0133.22.6a1 1 0 01.65-.16h1.54a.36.36.0 01.41.41 1.36 1.36.0 010 .26 3.64 3.64.0 01-.12.41l-4 12.86a1.3 1.3.0 01-.35.65 1 1 0 01-.64.16H29.25a1 1 0 01-.67-.17 1.26 1.26.0 01-.32-.67L25.67 3.64l-2.56 10.7a1.26 1.26.0 01-.32.67 1 1 0 01-.67.17zm21.36.44a11.28 11.28.0 01-2.56-.29 7.44 7.44.0 01-1.92-.67 1 1 0 01-.61-.93v-.84q0-.52.38-.52a.9.9.0 01.31.06l.42.17a8.77 8.77.0 001.83.58 9.78 9.78.0 002 .2 4.48 4.48.0 002.43-.55 1.76 1.76.0 00.86-1.57 1.61 1.61.0 00-.45-1.16A4.29 4.29.0 0043 9.22l-2.41-.76A5.15 5.15.0 0138 6.78a3.94 3.94.0 01-.83-2.41 3.7 3.7.0 01.45-1.85 4.47 4.47.0 011.19-1.37 5.27 5.27.0 011.7-.86A7.4 7.4.0 0142.6.0a8.87 8.87.0 011.12.07q.57.07 1.08.19t.95.26a4.27 4.27.0 01.7.29 1.59 1.59.0 01.49.41.94.94.0 01.15.55v.79q0 .52-.38.52a1.76 1.76.0 01-.64-.2 7.74 7.74.0 00-3.2-.64 4.37 4.37.0 00-2.21.47 1.6 1.6.0 00-.79 1.48 1.58 1.58.0 00.49 1.18 4.94 4.94.0 001.83.92L44.55 7a5.08 5.08.0 012.57 1.6A3.76 3.76.0 0147.9 11a4.21 4.21.0 01-.44 1.93 4.4 4.4.0 01-1.21 1.47 5.43 5.43.0 01-1.85.93A8.25 8.25.0 0142.05 15.62z"/><path class="cls-2" d="M45.19 23.81C39.72 27.85 31.78 30 25 30A36.64 36.64.0 01.22 20.57c-.51-.46-.06-1.09.56-.74A49.78 49.78.0 0025.53 26.4 49.23 49.23.0 0044.4 22.53C45.32 22.14 46.1 23.14 45.19 23.81z"/><path class="cls-2" d="M47.47 21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74 3.13-2.2 8.27-1.57 8.86-.83s-.16 5.89-3.09 8.35c-.45.38-.88.18-.68-.32C46.69 25.8 48.17 22.11 47.47 21.21z"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=../../js/lunr.min.js?1765296817></script><script type=text/javascript src=../../js/auto-complete.js?1765296817></script><script type=text/javascript>var baseurl="https://thormastran.github.io/fcj-workshop-template/"</script><script type=text/javascript src=../../js/search.js?1765296817></script></div><div class=highlightable><ul class=topics><li data-nav-id=/1-worklog/ title="üìù Worklog Journey" class=dd-item><a href=../../1-worklog/><b>1. </b>üìù Worklog Journey
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/1-worklog/1.1-week1/ title="Week 1 Worklog" class=dd-item><a href=../../1-worklog/1.1-week1/><b>1.1. </b>Week 1 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.2-week2/ title="Week 2 Worklog" class=dd-item><a href=../../1-worklog/1.2-week2/><b>1.2. </b>Week 2 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.3-week3/ title="Week 3 Worklog" class=dd-item><a href=../../1-worklog/1.3-week3/><b>1.3. </b>Week 3 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.4-week4/ title="Week 4 Worklog" class=dd-item><a href=../../1-worklog/1.4-week4/><b>1.4. </b>Week 4 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.5-week5/ title="Week 5 Worklog" class=dd-item><a href=../../1-worklog/1.5-week5/><b>1.5. </b>Week 5 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.6-week6/ title="Week 6 Worklog" class=dd-item><a href=../../1-worklog/1.6-week6/><b>1.6. </b>Week 6 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.7-week7/ title="Week 7 Worklog" class=dd-item><a href=../../1-worklog/1.7-week7/><b>1.7. </b>Week 7 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.8-week8/ title="Week 8 Worklog" class=dd-item><a href=../../1-worklog/1.8-week8/><b>1.8. </b>Week 8 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.9-week9/ title="Week 9 Worklog" class=dd-item><a href=../../1-worklog/1.9-week9/><b>1.9. </b>Week 9 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.10-week10/ title="Week 10 Worklog" class=dd-item><a href=../../1-worklog/1.10-week10/><b>1.10. </b>Week 10 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.11-week11/ title="Week 11 Worklog" class=dd-item><a href=../../1-worklog/1.11-week11/><b>1.11. </b>Week 11 Worklog
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/1-worklog/1.12-week12/ title="Week 12 Worklog" class=dd-item><a href=../../1-worklog/1.12-week12/><b>1.12. </b>Week 12 Worklog
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/2-proposal/ title=Proposal class=dd-item><a href=../../2-proposal/><b>2. </b>Proposal
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/ title="Translated Blogs" class="dd-item
parent"><a href=../../3-blogstranslated/><b>3. </b>Translated Blogs
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/3-blogstranslated/3.1-blog1/ title="Blog 1" class=dd-item><a href=../../3-blogstranslated/3.1-blog1/><b>3.1. </b>Blog 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.2-blog2/ title="Blog 2" class="dd-item
active"><a href=../../3-blogstranslated/3.2-blog2/><b>3.2. </b>Blog 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/3-blogstranslated/3.3-blog3/ title="Blog 3" class=dd-item><a href=../../3-blogstranslated/3.3-blog3/><b>3.3. </b>Blog 3
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/4-eventparticipated/ title="Events Participated" class=dd-item><a href=../../4-eventparticipated/><b>4. </b>Events Participated
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/4-eventparticipated/4.1-event1/ title="Event 1" class=dd-item><a href=../../4-eventparticipated/4.1-event1/><b>4.1. </b>Event 1
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.2-event2/ title="Event 2" class=dd-item><a href=../../4-eventparticipated/4.2-event2/><b>4.2.</b>Event 2
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.3-event3/ title="Event 3" class=dd-item><a href=../../4-eventparticipated/4.3-event3/><b>4.3.</b>Event 3
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.4-event4/ title="Event 4" class=dd-item><a href=../../4-eventparticipated/4.4-event4/><b>4.4.</b>Event 4
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.5-event5/ title="Event 5" class=dd-item><a href=../../4-eventparticipated/4.5-event5/><b>4.5.</b>Event 5
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/4-eventparticipated/4.6-event6/ title="Event 6" class=dd-item><a href=../../4-eventparticipated/4.6-event6/><b>4.6.</b>Event 6
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/ title="AWS Cognito with Amplify SDK Workshop" class=dd-item><a href=../../5-workshop/><b>5.</b> AWS Cognito with Amplify SDK Workshop
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.1-workshop-overview/ title="Workshop Overview" class=dd-item><a href=../../5-workshop/5.1-workshop-overview/><b>5.1. </b>Workshop Overview
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.2-prerequiste/ title=Prerequiste class=dd-item><a href=../../5-workshop/5.2-prerequiste/><b>5.2. </b>Prerequiste
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-aws-cognito/ title="AWS Cognito Setup" class=dd-item><a href=../../5-workshop/5.3-aws-cognito/><b>5.3. </b>AWS Cognito Setup
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.3-aws-cognito/5.3.1-create-cognito/ title="Create a Cognito User Pool" class=dd-item><a href=../../5-workshop/5.3-aws-cognito/5.3.1-create-cognito/><b>5.3.1 </b>Create a Cognito User Pool
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.3-aws-cognito/5.3.2-configure-appclient/ title="Configure App Client" class=dd-item><a href=../../5-workshop/5.3-aws-cognito/5.3.2-configure-appclient/><b>5.3.2 </b>Configure App Client
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.4-next.js-setup/ title="Next.js Project Setup & Amplify Configuration" class=dd-item><a href=../../5-workshop/5.4-next.js-setup/><b>5.4. </b>Next.js Project Setup & Amplify Configuration
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.4-next.js-setup/5.4.1-install-nextjs/ title="Install Next.js Project" class=dd-item><a href=../../5-workshop/5.4-next.js-setup/5.4.1-install-nextjs/><b>5.4.1 </b>Install Next.js Project
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.4-next.js-setup/5.4.2-install-amplify/ title="Install Amplify SDK and Configure Amplify" class=dd-item><a href=../../5-workshop/5.4-next.js-setup/5.4.2-install-amplify/><b>5.4.2 </b>Install Amplify SDK and Configure Amplify
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.5-cognito-function/ title="Authentication Functions, UI, and Protected Routes" class=dd-item><a href=../../5-workshop/5.5-cognito-function/><b>5.5. </b>Authentication Functions, UI, and Protected Routes
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/5-workshop/5.5-cognito-function/5.5.1-auth-functions/ title="Create Authentication Functions" class=dd-item><a href=../../5-workshop/5.5-cognito-function/5.5.1-auth-functions/><b>5.5.1 </b>Create Authentication Functions
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-cognito-function/5.5.2-auth-ui/ title="Build Authentication UI" class=dd-item><a href=../../5-workshop/5.5-cognito-function/5.5.2-auth-ui/><b>5.5.2 </b>Build Authentication UI
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-cognito-function/5.5.3-protected-routes/ title="Implement Auth Context & Protected Routes" class=dd-item><a href=../../5-workshop/5.5-cognito-function/5.5.3-protected-routes/><b>5.5.3 </b>Implement Auth Context & Protected Routes
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.5-cognito-function/5.5.4-use-project-demo/ title="Use demo project for cognito authentication" class=dd-item><a href=../../5-workshop/5.5-cognito-function/5.5.4-use-project-demo/><b>5.5.4 </b>Use demo project for cognito authentication
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/5-workshop/5.6-testing/ title="Full Testing & Verification" class=dd-item><a href=../../5-workshop/5.6-testing/><b>5.6 </b>Full Testing & Verification
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/5-workshop/5.7-cleanup/ title="Clean Up Resources" class=dd-item><a href=../../5-workshop/5.7-cleanup/><b>5.7 </b>Clean Up Resources
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/6-self-evaluation/ title=Self-Assessment class=dd-item><a href=../../6-self-evaluation/><b>6. </b>Self-Assessment
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/7-feedback/ title="Sharing and Feedback" class=dd-item><a href=../../7-feedback/><b>7. </b>Sharing and Feedback
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://www.facebook.com/groups/awsstudygroupfcj/><i class='fab fa-facebook'></i> AWS Study Group</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding><i class="fas fa-language fa-fw"></i><div class=select-style><select id=select-language onchange="location=this.value"><option id=en value=https://thormastran.github.io/fcj-workshop-template/3-blogstranslated/3.2-blog2/ selected>English</option><option id=vi value=https://thormastran.github.io/fcj-workshop-template/vi/3-blogstranslated/3.2-blog2/>Ti·∫øng Vi·ªát</option></select><svg id="Capa_1" xmlns:xlink="http://www.w3.org/1999/xlink" width="255" height="255" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255"><g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g></svg></div></a></li><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></section><section id=footer><left><b>Workshop</b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title=Migrate alt="web counter" border=0></a><br><b><a href=https://cloudjourney.awsstudygroup.com/>Cloud Journey</a></b><br><img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" alt="web counter" border=0>
</left><left><br><br><b>Last Updated</b><br><i><span id=lastUpdated style=color:orange></span>
</i><script>const today=new Date,formattedDate=today.toLocaleDateString("en-GB");document.getElementById("lastUpdated").textContent=formattedDate</script></left><left><br><br><b>Team</b><br><i><a href=https://www.facebook.com/groups/660548818043427 style=color:orange>First Cloud Journey</a><br></i></left><script async defer src=https://buttons.github.io/buttons.js></script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=../../>Internship Report</a> > <a href=../../3-blogstranslated/>Translated Blogs</a> > Blog 2</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#aws-fault-injection-service-fis-overview>AWS Fault Injection Service (FIS) overview</a></li><li><a href=#amazon-systems-manager--run-command-overview>Amazon Systems Manager ‚Äì Run Command overview</a></li><li><a href=#integration-overview>Integration overview</a></li><li><a href=#best-practices--systems-manager-documents>Best practices ‚Äì Systems Manager documents</a><ul><li><a href=#clear-parameter-definitions><strong>Clear parameter definitions</strong></a></li><li><a href=#detecting-amazon-linux><strong>Detecting Amazon Linux</strong></a></li><li><a href=#detecting-centosrhel><strong>Detecting CentOS/RHEL</strong></a></li></ul></li><li><a href=#code-best-practices>Code best practices</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Blog 2</h1><div class="notices warning"><p>‚ö†Ô∏è <strong>Note:</strong> The information below is for reference purposes only. Please <strong>do not copy verbatim</strong> for your report, including this warning.</p></div><h1 id=best-practices-for-utilizing-aws-systems-manager-with-aws-fault-injection-service>Best practices for utilizing AWS Systems Manager with AWS Fault Injection Service</h1><p>by David Christian, Hans Nesbitt, and Neill Reidy on 26 JUN 2025 in <a href=https://aws.amazon.com/blogs/mt/category/learning-levels/advanced-300/>Advanced (300)</a>, <a href=https://aws.amazon.com/blogs/mt/category/developer-tools/aws-fault-injection-service-fis/>AWS Fault Injection Service (FIS)</a>, <a href=https://aws.amazon.com/blogs/mt/category/management-tools/aws-systems-manager/>AWS Systems Manager</a>, <a href=https://aws.amazon.com/blogs/mt/category/post-types/best-practices/>Best Practices</a>, <a href=https://aws.amazon.com/blogs/mt/category/management-tools/>Management Tools</a>, <a href=https://aws.amazon.com/blogs/mt/category/post-types/technical-how-to/s>Technical How-to</a><a href=https://aws.amazon.com/blogs/mt/best-practices-for-utilizing-aws-systems-manager-with-aws-fault-injection-service/>Permalink</a> Share</p><hr><h2 id=introduction>Introduction</h2><p>In today‚Äôs cloud-centric world, ensuring the resilience of mission-critical applications is paramount. The ability to withstand and recover from unexpected failures, including degradation of cloud provider services, can mean the difference between seamless operation and costly downtime. This is where the powerful combination of <a href=https://aws.amazon.com/systems-manager/>AWS Systems Manager (SSM)</a> and <a href=https://aws.amazon.com/fis/>AWS Fault Injection Service (AWS FIS)</a> comes into play.</p><p>FIS, launched in 2021, is a fully managed service designed to perform fault injection experiments on AWS workloads, improving reliability and resilience. While FIS provides built-in capabilities for simulating disruptive events, its integration with SSM opens a world of possibilities for creating custom, fine-grained fault injection experiments.</p><p>In this blog post, we‚Äôll explore best practices for using SSM with FIS. We‚Äôll delve into how this powerful duo can be leveraged to create more comprehensive and realistic chaos engineering experiments, going beyond the standard FIS actions to simulate a wider range of failure scenarios.</p><p>These testing techniques help ensure your critical applications‚Äîwhether they‚Äôre custom-built solutions, enterprise systems like SAP, or web applications running on IIS‚Äîremain reliable and highly available. Using SSM, you can implement comprehensive application testing that goes beyond basic infrastructure checks to verify your entire application stack is performing as expected. This approach has helped organizations prevent service disruptions and deliver consistent experiences to their end users.</p><h2 id=aws-fault-injection-service-fis-overview>AWS Fault Injection Service (FIS) overview</h2><p>FIS is a managed service that enables you to perform fault injection experiments on your AWS workloads. Fault injection is based on the principles of chaos engineering. These experiments stress an application by creating disruptive events so that you can observe how your application responds. You can then use this information to improve the performance and resiliency of your applications. With FIS, you set up and run experiments that help you create the real-world conditions needed to uncover application issues.</p><h2 id=amazon-systems-manager--run-command-overview>Amazon Systems Manager ‚Äì Run Command overview</h2><p>SSM helps you centrally view, manage, and operate instances at scale in AWS, on-premises, and multi-cloud environments. With the launch of a unified console experience, SSM consolidates various tools to help you complete common tasks across managed nodes (such as <a href=https://aws.amazon.com/ec2/>Amazon Elastic Compute Cloud (EC2)</a> instances, edge devices, or on-premises servers) across AWS accounts and Regions.</p><p>SSM‚Äôs Run Command lets you execute bash and PowerShell scripts across your entire fleet of systems‚Äîenabling everything from routine administrative tasks to complex configuration changes and even fault injection testing. This powerful capability works on any managed node, whether it‚Äôs an Amazon EC2 instance or a non-EC2 machine in your hybrid and multi-cloud environment. You can trigger these scripts through multiple interfaces, including the AWS Management Console, <a href=https://aws.amazon.com/cli/>AWS Command Line Interface (AWS CLI)</a>, <a href=https://aws.amazon.com/powershell/>AWS Tools for PowerShell</a>, or AWS SDKs.</p><h2 id=integration-overview>Integration overview</h2><p>FIS can execute fault injection experiments through Systems Manager using two actions: aws:ssm:send-command for SSM documents directly on EC2 instances, and aws:ssm:start-automation-execution for executing automation workflows. The send-command action is ideal for direct fault injection scenarios, while start-automation-execution is better suited for complex, multi-step fault injection experiments requiring orchestration. In this blog post, we‚Äôll focus on using aws:ssm:send-command.</p><p>For direct command execution, AWS provides predefined fault injection documents (prefixed with AWSFIS) that handles common fault scenarios, like CPU spikes, disk consumption, memory leaks, and network packet loss. You can also create your own SSM Command documents containing custom fault injection logic that will be executed using the aws:ssm:send-command action.</p><p>SSM Agent is Amazon software that can be installed and configured on EC2 instances, on-premises servers, or virtual machines (VMs). This makes it possible for Systems Manager to manage these resources. The agent processes requests from SSM and then runs them as specified in the request. The AWS Systems Manager Console example below shows the FIS documents.</p><p>Note: The pre-configured SSM documents provided by FIS are supported only on EC2 instances. They are not supported on other types of managed nodes, such as on-premises servers.</p><p>More details on the AWSFIS documents can be found in the <a href=https://docs.aws.amazon.com/fis/latest/userguide/actions-ssm-agent.html>user guide</a>.
<img alt=" picture" src=../../images/3-BlogsTranslated/image6.png>
Figure 1: Fault Injection documents available within AWS Systems Manager</p><h2 id=best-practices--systems-manager-documents>Best practices ‚Äì Systems Manager documents</h2><p>This section will cover best practices for implementing SSM documents for use with FIS. We will cover structure, parameter definition, OS detection, and preconditions.</p><ul><li>Modular structure : Break down your documents into distinct, logical steps‚Äîsimilar to how AWS-managed documents typically separate dependency installation from script execution. This modular approach allows for independent failure handling, meaning if one step fails, you can isolate and address that specific issue without impacting other components. Each step can include its own cleanup actions, making it easier to roll back changes and return systems to a known good state when problems occur. The clear separation between steps also simplifies troubleshooting by helping you quickly pinpoint where issues arise, while well-defined modules can be reused across different automation documents.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;mainSteps&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> [
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;action&#34;</span>: <span style=color:#e6db74>&#34;aws:runPowerShellScript&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;ValidatePrerequisites&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;action&#34;</span>: <span style=color:#e6db74>&#34;aws:runPowerShellScript&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;StopIISAppPool&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Stop specified IIS Application Pool&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;action&#34;</span>: <span style=color:#e6db74>&#34;aws:runPowerShellScript&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;RestoreIISAppPool&#34;</span>, 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Restore IIS Application Pool to running state&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#960050;background-color:#1e0010>...</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><h3 id=clear-parameter-definitions><strong>Clear parameter definitions</strong></h3><p>Clear parameter definitions: Parameters are defined with type, description, and often include default values and allowed patterns. Parameters are validated using allowedPattern or allowedValues to ensure correct input.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;IISAppPoolName&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;String&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;default&#34;</span>: <span style=color:#e6db74>&#34;DefaultAppPool&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Name of the Windows IIS Application Pool to Stop&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;allowedPattern&#34;</span>: <span style=color:#e6db74>&#34;^[a-zA-Z0-9]{1,50}$&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><p>Leverage environment variables for dynamic configuration: Always use SSM‚Äôs built-in environment variables (like AWS_SSM_REGION_NAME) instead of hardcoding values in your scripts. This practice ensures your automation remains portable across different regions and accounts, reduces the risk of errors from manual updates, and makes your documents more maintainable. For example, rather than embedding region-specific endpoints or paths, reference AWS_SSM_REGION_NAME to automatically adapt your scripts to whatever region they‚Äôre running in. You can view variables in your session by running an AWS Run Command for the AWS-RunShellScript document and pass the appropriate command for your OS. For example, pass printenv as a command to view environment variables on Linux.</p></li><li><p>OS detection: Implement operating system detection to enable cross-platform automation. By identifying the OS type and version before executing any commands, you can properly handle the variations across different systems. This detect-then-execute pattern allows your automation to dynamically select the appropriate package manager (such as yum for Amazon Linux/CentOS or apt for Ubuntu), locate system files correctly, and use the right command line tools for each platform. This approach ensures your automation remains reliable and consistent whether you&rsquo;re managing a homogeneous environment or a diverse fleet of Linux distributions.</p></li></ul><h3 id=detecting-amazon-linux><strong>Detecting Amazon Linux</strong></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;/etc/system-release&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> grep -i <span style=color:#e6db74>&#39;Amazon Linux&#39;</span> /etc/system-release ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ! grep -Fiq <span style=color:#e6db74>&#39;VERSION_ID=&#34;2023&#34;&#39;</span> /etc/os-release ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Amazon Linux 2 or earlier</span>
</span></span><span style=display:flex><span>        yum -y install &lt;package&gt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> grep -Fiq <span style=color:#e6db74>&#39;ID=&#34;amzn&#34;&#39;</span> /etc/os-release <span style=color:#f92672>&amp;&amp;</span> grep -Fiq <span style=color:#e6db74>&#39;VERSION_ID=&#34;2023&#34;&#39;</span> /etc/os-release ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Amazon Linux 2023</span>
</span></span><span style=display:flex><span>        yum -y install &lt;package&gt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;Exiting - This SSM document supports: Amazon Linux, Ubuntu, CentOS (7, Stream 8, Stream 9)&#34;</span>
</span></span><span style=display:flex><span>        exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><h3 id=detecting-centosrhel><strong>Detecting CentOS/RHEL</strong></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>elif</span> grep -Fiq <span style=color:#e6db74>&#39;ID=&#34;centos&#34;&#39;</span> /etc/os-release <span style=color:#f92672>||</span> grep -Fiq <span style=color:#e6db74>&#39;ID=&#34;rhel&#34;&#39;</span> /etc/os-release ; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Fetch OS Version</span>
</span></span><span style=display:flex><span>    os_version_number<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>grep -oP <span style=color:#e6db74>&#39;(?&lt;=^VERSION_ID=).+&#39;</span> /etc/os-release | tr -d <span style=color:#e6db74>&#39;&#34;&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># If the version has a decimal, this line will remove it</span>
</span></span><span style=display:flex><span>    os_major_version_number<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>os_version_number%.*<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ... (EPEL repository setup)</span>
</span></span><span style=display:flex><span>    yum -y install &lt;package&gt;
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><ul><li>Preconditions: Create unified, intelligent automation by using preconditions in your SSM documents. Rather than maintaining separate Windows and Linux documents, write a single document that automatically executes the right commands for each platform. For example, your document can use ‚ÄòplatformType‚Äô preconditions to run PowerShell commands on Windows servers while executing bash scripts on Linux instances. You can also control workflow logic by using preconditions to check step completion‚Äîlike verifying dependencies are installed before proceeding to configuration steps. This is done by setting a precondition that checks if a previous step completed successfully, for example, ‚ÄòStringEquals: InstallDependencies: True‚Äô. This approach ensures that steps execute in the correct order and only when previous requirements are met, while still maintaining platform-specific intelligence. The result is more reliable automation that works across your entire infrastructure, with built-in validation between steps.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>action</span>: <span style=color:#ae81ff>aws:runShellScript</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>InstallDependencies</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>precondition</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>StringEquals</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>platformType</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>Linux</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>     <span style=color:#75715e># step inputs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>action</span>: <span style=color:#ae81ff>aws:runShellScript</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ConfigureApplication</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>precondition</span>:
</span></span><span style=display:flex><span>   <span style=color:#f92672>StringEquals</span>:
</span></span><span style=display:flex><span>    - <span style=color:#e6db74>&#39;{{ InstallDependencies }}&#39;</span>
</span></span><span style=display:flex><span>    - <span style=color:#e6db74>&#39;True&#39;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># step inputs</span>
</span></span></code></pre></div><ul><li>OnFailure: Handle the flow of execution in the document by leveraging the OnFailure field. OnFailure supports two values ‚Äòexit‚Äô or ‚ÄòsuccessAndExit‚Äô. Both immediately stop processing any steps that haven‚Äôt been defined as a ‚ÄòfinallyStep‚Äô. The difference between the two is that ‚Äòexit‚Äô will return a failure status, but successAndExit will return success. Since we are running these in the context of FIS, we want the failure to also fail the experiment. OnFailure: exit is also a good pattern to add to your prerequisites to ensure the target is ready to run the experiment. Here‚Äôs what the previous example looks like with the onFailure added.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>action</span>: <span style=color:#ae81ff>aws:runShellScript</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>InstallDependencies</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>precondition</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>StringEquals</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>platformType</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>Linux</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>-	onFailure</span>: <span style=color:#ae81ff>exit</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># step inputs</span>
</span></span></code></pre></div><h2 id=code-best-practices>Code best practices</h2><p>We will now look at what can we do within the SSM FIS code to ensure best practices at all layers of the automation. For additional SSM Run Command best practices, refer <a href=https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-best-practices.html>use cases and best practices.</a></p><ul><li>Idempotency: Implement idempotency in your scripts to ensure reliability and prevent unintended side effects during retries or repeated executions. This means your script must thoroughly check the current state of the system before making any changes and only perform actions when necessary. For example, before installing software, verify if it‚Äôs already installed and at the correct version; before modifying configurations, confirm they aren‚Äôt already at the desired state. Design your scripts to handle interrupted executions gracefully by implementing state tracking mechanisms (such as status files or SSM Parameter Store entries) that record progress and allow subsequent runs to pick up where they left off.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Check if experiment is already running</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (Test-Path -Path <span style=color:#e6db74>&#39;C:\temp\fis_windows_iis_experiment.json&#39;</span>) {
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;ERROR: fis_windows_iis_experiment.json already exists. Exiting.&#34;</span>
</span></span><span style=display:flex><span>    Exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Verify service exists before attempting operations</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>-not</span> (Get-IISAppPool -Name {{IISAppPoolName}} -ErrorAction SilentlyContinue)) {
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;ERROR: Application Pool {{IISAppPoolName}} not found&#34;</span>
</span></span><span style=display:flex><span>    Exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>Timeouts: Set appropriate timeouts in your automation steps to enforce operational safety and enable proper error handling. Each step should include a ‚ÄòtimeoutSeconds‚Äô parameter that reflects both the expected execution time and your tolerance for delayed completion. This timeout acts as a critical safety mechanism‚Äîwhen a step exceeds its timeout, Systems Manager will terminate the execution and trigger cleanup procedures. This approach ensures your automation doesn‚Äôt leave systems in an unknown state during failures. For example, if a software installation step times out, your script should include cleanup logic to roll back any partial changes, such as removing incomplete installations or restoring original configurations. By combining timeouts with proper cleanup procedures, you maintain system integrity even when the control structure around your scripts fails or become unresponsive. Example from the AWSFIS-Run-CPU-Stress.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>- action: aws:runShellScript
</span></span><span style=display:flex><span>  name: StopService
</span></span><span style=display:flex><span>  inputs:
</span></span><span style=display:flex><span>    timeoutSeconds: <span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span>    runCommand:
</span></span><span style=display:flex><span>      - |
</span></span><span style=display:flex><span>        <span style=color:#75715e>#!/bin/bash</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># script content here</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#################################</span>
</span></span><span style=display:flex><span><span style=color:#75715e># General post fault-execution logic #</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#################################</span>
</span></span><span style=display:flex><span>DURATION<span style=color:#f92672>={{</span> DurationSeconds <span style=color:#f92672>}}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> -z $start_time <span style=color:#f92672>]]</span>;<span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    &gt;&amp;<span style=color:#ae81ff>2</span> echo <span style=color:#e6db74>&#34;start_time is not defined&#34;</span>
</span></span><span style=display:flex><span>    exit 1;
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>elapsed_time<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span> <span style=color:#66d9ef>$(</span>date +%s<span style=color:#66d9ef>)</span> <span style=color:#f92672>-</span> start_time <span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Fail if the fault command exits successfully but the execution duration is less than the expected duration.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This happens when Stress-ng is killed prematurely using SIGTERM or SIGINT.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$elapsed_time<span style=color:#e6db74>&#34;</span> -lt <span style=color:#e6db74>&#34;</span>$DURATION<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    &gt;&amp;<span style=color:#ae81ff>2</span> echo <span style=color:#e6db74>&#34;Fault took </span>$elapsed_time<span style=color:#e6db74> seconds to execute, which is less than expected duration </span>$DURATION<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    exit 1;
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><ul><li>Logging: Scripts should include echo statements to log progress and the result of the Run command SSM document. Command output can be viewed in a number of ways and is useful for debugging the document as well as recording success messages throughout the duration of the execution. Output options can be configured as part of the Run Command, logging can be viewed by navigating to the command history in SSM, or via <a href=https://aws.amazon.com/s3/>Amazon Simple Storage Service (Amazon S3)</a> bucket or <a href=https://aws.amazon.com/cloudwatch/>Amazon CloudWatch</a> logs. Note that <a href=https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-rc-setting-up-cwlogs.html>additional configuration steps</a> are required for setting up the S3 bucket logging and/or CloudWatch logs. Also, logging can be redirected to the local OS /tmp location which may be valuable in more complex scenarios.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#66d9ef>function</span> Write-Log {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>param</span>($Message)
</span></span><span style=display:flex><span>    $timestamp = Get-Date -Format <span style=color:#e6db74>&#39;yyyy-MM-dd HH:mm:ss&#39;</span>
</span></span><span style=display:flex><span>    Write-Host <span style=color:#e6db74>&#34;[</span>$timestamp<span style=color:#e6db74>] </span>$Message<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Logging example</span>
</span></span><span style=display:flex><span>Write-Log <span style=color:#e6db74>&#34;Stopping IIS Application Pool: {{IISAppPoolName}}&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Rollback implementation</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;Restoring IIS Application Pool: {{IISAppPoolName}}&#34;</span>
</span></span><span style=display:flex><span>    Start-WebAppPool -Name {{IISAppPoolName}}
</span></span><span style=display:flex><span>    $startedPool = Get-IISAppPool -Name {{IISAppPoolName}}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($startedPool.State <span style=color:#f92672>-ne</span> <span style=color:#e6db74>&#39;Started&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#e6db74>&#34;Failed to start application pool&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>catch</span> {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;ERROR during restoration: </span>$($_.Exception.Message)<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Output options can be configured in AWS Systems Manager > Node Tools > Run Command</p><p><img alt=" picture" src=../../images/3-BlogsTranslated/image7.png>
Figure 2: Output Options</p><p>Run command output can be viewed after a job is run by navigating to ‚ÄúCommand history‚Äù and choosing ‚ÄúView output‚Äù</p><p><img alt=" picture" src=../../images/3-BlogsTranslated/image8.png>
Figure 3: ‚Äì Output from run command</p><ul><li>Cleanup Procedures: As idempotency is a desired characteristic, we must clean up once we have completed our impairment to allow for the experiment to be re-ran. Implement cleanup procedures to remove temporary files, restore service configurations, and reset system states to their original condition. Your cleanup routines should be as thorough as your setup procedures, ensuring that each experiment truly starts from a clean slate. This includes removing any temporary files, restoring original configuration files, clearing cached data, and verifying service states. Always implement proper error handling and logging during cleanup, as failed cleanup procedures can compromise the idempotency of future experiment runs.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Windows (IIS) Cleanup Example</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;Cleaning up: Deleting JSON file C:\\temp\\fis_windows_iis_experiment.json&#34;</span>
</span></span><span style=display:flex><span>    Remove-Item -Path C:\\temp\\fis_windows_iis_experiment.json -Force
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;JSON file deleted successfully&#34;</span>
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>catch</span> {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;ERROR during cleanup: </span>$($_.Exception.Message)<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>throw</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Linux (HTTPD) Cleanup Example</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;Cleaning up: Deleting /tmp/fis_linux_service_experiment.json&#39;</span>
</span></span><span style=display:flex><span>rm -f /tmp/fis_linux_service_experiment.json echo <span style=color:#e6db74>&#39;JSON file deleted successfully.&#39;</span>
</span></span></code></pre></div><ul><li>Service State Restoration: Your FIS experiment will stress an application in testing or production environments by creating disruptive events. As chaos testing matures into production environments, it‚Äôs critical to implement checks to ensure services are properly restored.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Windows (IIS) Service Restoration</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;Restoring IIS Application Pool: {{IISAppPoolName}}&#34;</span>
</span></span><span style=display:flex><span>    Start-WebAppPool -Name {{IISAppPoolName}}
</span></span><span style=display:flex><span>    $startedPool = Get-IISAppPool -Name {{IISAppPoolName}}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($startedPool.State <span style=color:#f92672>-ne</span> <span style=color:#e6db74>&#39;Started&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#e6db74>&#34;Failed to start application pool&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;Application Pool restored successfully&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>catch</span> {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;ERROR during restoration: </span>$($_.Exception.Message)<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Linux (HTTPD) Service Restoration</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;Restoring service {{ServiceName}}&#39;</span>
</span></span><span style=display:flex><span>sudo systemctl start <span style=color:#f92672>{{</span>ServiceName<span style=color:#f92672>}}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ! systemctl is-active --quiet <span style=color:#f92672>{{</span>ServiceName<span style=color:#f92672>}}</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#39;ERROR: Failed to start service {{ServiceName}}&#39;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;Service restored successfully.&#39;</span>
</span></span></code></pre></div><ul><li>Duration Management: Proper rollback includes managing experiment duration and ensuring timely restoration. As chaos engineering practices evolve, timing of the experiment will become more precise. Other factors may come into play as part of the experiment depending on architecture being tested; for example, dynamic scaling methods may be in place for Auto Scaling Groups. Refer <a href=https://docs.aws.amazon.com/fis/latest/userguide/getting-started-planning.html>planning your AWS FIS experiments</a> for more details.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Windows Duration Management</span>
</span></span><span style=display:flex><span>$elapsed_time = ((Get-Date) - $start_time).TotalSecondsWrite-Log <span style=color:#e6db74>&#34;Elapsed time: </span>$elapsed_time<span style=color:#e6db74> seconds&#34;</span>
</span></span><span style=display:flex><span>$remaining_time = {{DurationSeconds}} - $elapsed_time
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ($remaining_time <span style=color:#f92672>-gt</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;Waiting for remaining time: </span>$remaining_time<span style=color:#e6db74> seconds before restart&#34;</span>
</span></span><span style=display:flex><span>Start-Sleep -Seconds $remaining_time
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Linux Duration Management</span>
</span></span><span style=display:flex><span>elapsed_time<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span>current_time_epoch <span style=color:#f92672>-</span> start_time_epoch<span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>remaining_time<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span> <span style=color:#f92672>{{</span>DurationSeconds<span style=color:#f92672>}}</span> <span style=color:#f92672>-</span> elapsed_time <span style=color:#66d9ef>))if</span> <span style=color:#f92672>[</span> $remaining_time -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Waiting for remaining time: </span>$remaining_time<span style=color:#e6db74> seconds before restart&#34;</span>
</span></span><span style=display:flex><span>sleep $remaining_time
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><ul><li>Error Handling During Rollback: Implement comprehensive error handling during rollback operations. As part of the fault experiment, tests should include verbose error handling to aid in debugging and simplifying the ongoing journey of Chaos Engineering. Teams should take a continuous approach to resilience in the cloud, responding and learning based on success and failure of previous experiments. Refer to the <a href=https://docs.aws.amazon.com/prescriptive-guidance/latest/resilience-lifecycle-framework/introduction.html>Resilience lifecycle framework</a> for more guidance on resilience best practices and continuous improvement.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Windows Error Handling</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e># Restoration logic</span>
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>catch</span> {
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;ERROR: Rollback failed - </span>$($_.Exception.Message)<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    Write-Log <span style=color:#e6db74>&#34;Manual intervention may be required&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span>
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>finally</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e># Cleanup that must happen regardless of success/failure</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (Test-Path -Path <span style=color:#e6db74>&#39;C:\temp\fis_windows_iis_experiment.json&#39;</span>) {
</span></span><span style=display:flex><span>        Remove-Item -Path C:\temp\fis_windows_iis_experiment.json -Force
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>Systems Manager and Fault Injection Service provide a powerful platform for implementing chaos engineering principles and improving the resilience of your AWS workloads. By following the best practices outlined in this blog, you can create more robust, efficient, and maintainable SSM documents for use with FIS. Key takeaways include implementing a modular structure, proper parameter management, OS detection, comprehensive error handling and logging, robust rollback mechanisms, effective timeout management, and proper signal handling. Additionally, utilizing preconditions, adhering to <a href=https://docs.aws.amazon.com/fis/latest/userguide/security.html>security best practices</a>, and thorough testing are crucial for creating effective chaos engineering experiments.</p><p>As you continue to leverage SSM and FIS in your AWS environments, remember that chaos engineering is an ongoing process. Continuously refine your approach based on the insights gained from each experiment and stay updated with the latest features and best practices as noted in the <a href=https://docs.aws.amazon.com/prescriptive-guidance/latest/resilience-lifecycle-framework/introduction.html>AWS Resilience Lifecycle Framework</a>. Also, for those getting started with FIS, the <a href=https://catalog.us-east-1.prod.workshops.aws/workshops/eb89c4d5-7c9a-40e0-b0bc-1cde2df1cb97/en-US>Chaos Engineering</a> Workshop provides a safe environment to learn and practice experiments. By mastering the integration of Systems Manager with FIS and implementing these best practices, you‚Äôre taking a significant step towards building more resilient, fault-tolerant systems that can withstand the unpredictable nature of production environments. This not only improves your current fault injection experiments but also sets a solid foundation for future chaos engineering initiatives, ultimately leading to more reliable and robust AWS deployments.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=../../3-blogstranslated/3.1-blog1/ title="Blog 1"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=../../3-blogstranslated/3.3-blog3/ title="Blog 3" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=../../js/clipboard.min.js?1765296818></script><script src=../../js/perfect-scrollbar.min.js?1765296818></script><script src=../../js/perfect-scrollbar.jquery.min.js?1765296818></script><script src=../../js/jquery.sticky.js?1765296818></script><script src=../../js/featherlight.min.js?1765296818></script><script src=../../js/highlight.pack.js?1765296818></script><script>hljs.initHighlightingOnLoad()</script><script src=../../js/modernizr.custom-3.6.0.js?1765296818></script><script src=../../js/learn.js?1765296818></script><script src=../../js/hugo-learn.js?1765296818></script><link href=../../mermaid/mermaid.css?1765296818 rel=stylesheet><script src=../../mermaid/mermaid.js?1765296818></script><script>mermaid.initialize({startOnLoad:!0})</script><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,(e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date),(i=t.createElement(n),a=t.getElementsByTagName(n)[0]),i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-158079754-2","auto"),ga("send","pageview")</script></body></html>